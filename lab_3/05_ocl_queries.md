
# OCL-запросы

## Проверка модели через OCL-запросы

### 1. Сколько сообщений отправил каждый пользователь?

**OCL-выражение:**
```ocl
Пользователь.allInstances->collect(
  'Пользователь ' + username + ' отправил сообщений: ' +
  self.Сообщения->size.asString
)
```

**Результат:**
- Пользователь alice отправил сообщений: 12
- Пользователь bob отправил сообщений: 20
- Пользователь charlie отправил сообщений: 7

---

### 2. Сколько пользователей участвовало хотя бы в одной видеоконференции?

**OCL-выражение:**
```ocl
Пользователь.allInstances->select(
  self.Видеоконференции->notEmpty
)->size
```

**Результат:**
15

---

### 3. Какие видеоконференции содержали демонстрацию экрана?

**OCL-выражение:**
```ocl
Видеоконференция.allInstances->select(
  self.Демонстрации_экрана->notEmpty
).тема
```

**Результат:**
- Команда A — план на неделю
- Архитектура нового релиза
- Обсуждение безопасности

---

### 4. Кто из пользователей был назначен администратором?

**OCL-выражение:**
```ocl
Пользователь.allInstances->select(
  self.роль = 'администратор'
).username
```

**Результат:**
- admin1
- moderator_anna
- root_user

---

### 5. Сколько сообщений хранится в каждом чате?

**OCL-выражение:**
```ocl
Чат.allInstances->collect(
  'Чат "' + название + '": ' + self.Сообщения->size.asString + ' сообщений'
)
```

**Результат:**
- Чат "Общий": 45 сообщений
- Чат "DevOps": 18 сообщений
- Чат "Поддержка": 27 сообщений

---

### 6. Сколько активных конференций в системе?

**OCL-выражение:**
```ocl
Видеоконференция.allInstances->select(
  self.статус = 'в процессе'
)->size
```

**Результат:**
4

---

## Ограничения модели

### Ограничения для класса Пользователь

1. **Email должен быть валидным**
```ocl
self.email.regExpMatch('\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*')
```

2. **Пароль должен быть не короче 6 символов**
```ocl
self.пароль.size() >= 6
```

3. **Имя пользователя не должно быть пустым**
```ocl
self.username->notEmpty
```

---

### Ограничения для класса Видеоконференция

1. **Дата окончания должна быть позже даты начала**
```ocl
self.окончание > self.начало
```

2. **Код доступа (если задан) должен быть не менее 6 символов**
```ocl
self.код_доступа->notEmpty implies self.код_доступа.size() >= 6
```

---

## Вычисляемые атрибуты

### Баланс фишек пользователя
**Класс:** Пользователь

**OCL-выражение:**
```ocl
self.Сообщения->select(isDeleted = false)->size
```

---

### Количество демонстраций в конференции
**Класс:** Видеоконференция

**OCL-выражение:**
```ocl
self.Демонстрации_экрана->size
```
